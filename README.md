Quick port from another project.

Refactor incoming...